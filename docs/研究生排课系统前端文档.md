# 研究生排课系统 - 前端设计文档

## 1. 文档概述

### 1.1 文档目的

本文档明确研究生排课系统前端的技术架构、目录结构、页面设计、组件规范及开发约束，为AI工具生成前端代码和开发人员完善MVP提供清晰、可执行的技术指南，确保前端开发高效对齐业务需求。

### 1.2 核心目标

- 基于业务文档的角色权限体系，实现动态侧边栏与页面渲染

- 满足多角色（学生、教师、管理员、超级管理员）的差异化功能展示

- 保证前端与后端接口的无缝对接，支撑选课、排课、成绩管理等核心流程

- 实现响应式设计，适配桌面端与移动端访问

- 保障页面性能与用户体验，符合非功能需求中的性能指标

### 1.3 适用范围

- 前端技术栈选型落地

- 项目目录结构与文件组织

- 页面布局与组件设计

- 路由配置与权限控制

- 状态管理与数据交互

- 样式规范与响应式适配

## 2. 技术栈详情

### 2.1 核心技术栈

| 技术类别   | 选型明细        | 版本要求 | 核心用途                                 |
| ---------- | --------------- | -------- | ---------------------------------------- |
| 构建工具   | Vite            | 4+       | 项目构建、热更新、环境配置               |
| 框架核心   | Vue             | 3+       | 页面渲染、组件化开发                     |
| 类型检查   | TypeScript      | 4.9+     | 类型定义、代码健壮性保障                 |
| 路由管理   | Vue Router      | 4+       | 页面跳转、路由守卫、权限控制             |
| 状态管理   | Pinia           | 2+       | 全局状态共享（用户信息、权限、系统配置） |
| 样式处理   | SCSS            | 1.50+    | 样式预编译、变量复用、模块化样式         |
| UI组件库   | Naive UI        | 2.34+    | 基础组件、表单、弹窗等UI元素             |
| 图表可视化 | ECharts         | 5.4+     | 统计分析图表（选课率、成绩分布等）       |
| HTTP请求   | Axios           | 1.3+     | RPC 调用封装、拦截器配置                 |
| 项目管理   | pnpm + monorepo | pnpm 8+  | 多项目管理、依赖共享                     |

### 2.2 辅助工具

- 代码格式化：ESLint + Prettier（统一代码风格）

- 类型定义：@types/node + 自定义类型文件（完善TS类型覆盖）

- 图标库：Naive UI内置图标 + 自定义SVG图标（满足模块图标需求）

- 构建打包：Vite内置打包工具（开发/生产构建，前端不使用容器）

## 3. 项目目录结构

### 3.1 整体目录（monorepo结构）

```Plain Text
course_schedule_system/
├── package.json                # 根项目配置（pnpm workspace）
├── pnpm-workspace.yaml         # monorepo工作区配置
├── tsconfig.json               # 全局TS配置
├── eslint.config.ts            # 全局ESLint配置
├── .prettierrc                 # Prettier配置
├── apps/
│   ├── frontend/               # 前端子项目（核心目录）
│   └── backend/                # 后端子项目（由后端文档定义）
└── packages/                   # 共享包（可选，如通用类型、工具函数）
    ├── shared-types/           # 前后端共享类型定义
    └── shared-utils/           # 通用工具函数
```

### 3.2 前端子项目目录（apps/frontend）

```Plain Text
apps/frontend/
├── package.json                # 前端项目配置
├── vite.config.ts              # Vite配置（端口、代理、插件）
├── tsconfig.json               # 前端TS配置
├── index.html                  # 入口HTML
├── public/                     # 静态资源（图标、Logo、favicon）
├── src/
│   ├── main.ts                 # 入口文件（初始化Vue、路由、Pinia等）
│   ├── App.vue                 # 根组件（布局容器）
│   ├── api/                    # RPC 请求目录
│   │   ├── client.ts           # RPC 客户端封装（拦截器、入口 /rpc）
│   │   ├── auth.ts             # Auth.* 方法
│   │   ├── course.ts           # Course.* 方法
│   │   ├── enrollment.ts       # Enrollment.* 方法
│   │   ├── grade.ts            # Grade.* 方法
│   │   └── system.ts           # Admin/System.* 方法
│   ├── assets/                 # 静态资源目录
│   │   ├── icons/              # 自定义图标（SVG）
│   │   └── images/             # 图片资源（Logo、背景图）
│   ├── styles/                 # 样式与类型约定（统一到 styles）
│   │   ├── _variables.scss     # SCSS变量（颜色、字体、间距）
│   │   ├── _mixins.scss        # SCSS混合（响应式、阴影等）
│   │   ├── themes/             # 主题集合
│   │   └── types/              # 类型约定与说明
│   ├── components/             # 组件目录
│   │   ├── common/             # 通用组件（全局复用）
│   │   │   ├── PageHeader.vue  # 页面头部（标题、操作栏）
│   │   │   ├── StatCard.vue    # 统计卡片组件
│   │   │   ├── TablePagination.vue # 表格分页组件
│   │   │   ├── SearchInput.vue # 搜索输入框
│   │   │   └── PermissionWrapper.vue # 权限控制包装组件
│   │   ├── layout/             # 布局组件
│   │   │   ├── AppLayout.vue   # 整体布局（导航栏+侧边栏+主体内容）
│   │   │   ├── NavBar.vue      # 导航栏组件
│   │   │   ├── SidebarMenu.vue # 侧边栏菜单组件
│   │   │   ├── StatusBar.vue   # 状态栏/页脚组件
│   │   │   └── BottomNavigation.vue # 移动端底部导航
│   │   ├── student/            # 学生角色专属组件
│   │   ├── teacher/            # 教师角色专属组件
│   │   └── admin/              # 管理员/超级管理员专属组件
│   ├── hooks/                  # 自定义Hooks
│   │   ├── usePermission.ts    # 权限相关Hooks（检查权限、角色判断）
│   │   ├── useRequest.ts       # 请求相关Hooks（封装接口请求）
│   │   ├── useTable.ts         # 表格相关Hooks（分页、筛选）
│   │   └── useECharts.ts       # 图表相关Hooks（初始化ECharts）
│   ├── pages/                  # 页面目录（按模块划分）
│   │   ├── Login.vue           # 登录页面
│   │   ├── dashboard/          # 首页概览模块
│   │   │   ├── StudentDashboard.vue # 学生首页
│   │   │   ├── TeacherDashboard.vue # 教师首页
│   │   │   └── AdminDashboard.vue # 管理员首页
│   │   ├── course/             # 课程中心模块
│   │   │   ├── CourseBrowse.vue # 浏览课程
│   │   │   ├── CourseDetail.vue # 课程详情
│   │   │   ├── CourseManage.vue # 课程管理
│   │   │   └── CourseCreate.vue # 创建课程
│   │   ├── enrollment/         # 选课管理模块
│   │   │   ├── CourseSelection.vue # 选课操作
│   │   │   ├── MySchedule.vue  # 我的课表
│   │   │   └── EnrollmentManage.vue # 选课管理（教师/管理员）
│   │   ├── grade/              # 成绩管理模块
│   │   │   ├── MyGrades.vue    # 我的成绩（学生）
│   │   │   ├── GradeEntry.vue  # 成绩录入（教师）
│   │   │   └── GradeManage.vue # 成绩管理（管理员）
│   │   ├── analytics/          # 统计分析模块
│   │   ├── system/             # 系统管理模块
│   │   ├── messages/           # 消息中心模块
│   │   └── personal/           # 个人中心模块
│   ├── router/                 # 路由配置
│   │   ├── index.ts            # 路由实例（路由规则、嵌套路由）
│   │   ├── routes.ts           # 路由规则定义（按角色划分）
│   │   └── guard.ts            # 路由守卫（登录验证、权限检查）
│   ├── stores/                 # Pinia状态管理
│   │   ├── index.ts            # Pinia实例创建
│   │   ├── userStore.ts        # 用户信息状态（登录信息、角色）
│   │   ├── permissionStore.ts  # 权限状态（模块权限、菜单配置）
│   │   ├── systemStore.ts      # 系统状态（学期、选课状态）
│   │   └── appStore.ts         # 应用状态（主题、布局折叠）
└──
```

## 4. 核心设计详情

### 4.1 布局设计

#### 4.1.1 桌面端布局

- 整体结构：导航栏（上）+ 侧边栏（左）+ 主体内容（中）+ 状态栏（下）

- 布局组件：`AppLayout.vue` 统一包裹，通过Pinia状态控制侧边栏折叠/展开

- 响应式断点：
  - 大屏（≥1200px）：侧边栏宽度240px，主体内容自适应

  - 中屏（992px-1199px）：侧边栏宽度200px

  - 小屏（<992px）：隐藏侧边栏，显示移动端底部导航

#### 4.1.2 移动端布局

- 核心组件：`BottomNavigation.vue`（底部导航栏）

- 导航项：筛选侧边栏核心模块（最多5个，按order排序）

- 交互逻辑：点击底部导航项跳转对应页面，隐藏侧边栏

### 4.2 路由设计

#### 4.2.1 路由规则

- 公开路由：登录页（`/login`）

- 私有路由：需登录验证的页面（`/dashboard`、`/courses`等）

- 角色路由：按角色动态注册路由（如学生路由`/enrollment/select`、管理员路由`/system/users`）

- 嵌套路由：模块页面下的子页面（如`/courses/browse`、`/courses/manage`）

#### 4.2.2 路由守卫

- 登录守卫：未登录用户跳转至登录页

- 权限守卫：已登录用户访问无权限页面时，跳转至首页并提示

- 动态路由：登录后根据用户角色，动态添加对应路由规则

### 4.3 权限控制设计

#### 4.3.1 权限存储

- 存储位置：`permissionStore.ts`（Pinia）

- 存储内容：模块权限（是否可见/可访问）、操作权限（查看/创建/编辑等）、数据范围权限

- 缓存策略：本地存储缓存权限数据，5分钟刷新一次

#### 4.3.2 权限应用

- 路由级：路由守卫中检查模块访问权限

- 组件级：通过`PermissionWrapper.vue`组件控制组件显示/隐藏

- 操作级：按钮等操作元素通过权限判断是否禁用/显示

### 4.4 状态管理设计

| Store名称       | 核心状态                       | 核心Actions                         |
| --------------- | ------------------------------ | ----------------------------------- |
| userStore       | 用户信息、登录状态             | 登录、登出、更新用户信息            |
| permissionStore | 模块权限、菜单配置、数据范围   | 初始化权限、刷新权限、检查权限      |
| systemStore     | 当前学期、选课状态、系统配置   | 获取系统配置、更新选课状态          |
| appStore        | 主题模式、侧边栏折叠状态、语言 | 切换主题、折叠/展开侧边栏、切换语言 |

### 4.5 接口请求设计

#### 4.5.1 RPC 客户端配置

- 统一入口：`/rpc`；开发阶段统一从 `packages/config` 的 `devConfig` 读取 `baseUrl` 与 `rpcPath`，不使用根 `.env`。

- 请求拦截器：添加 JWT、构造 `{id, method, params, meta}`、设置 `Content-Type: application/json`

- 响应拦截器：统一错误处理（基于 `code` 与 `message`）、数据格式转换为前端模型

#### 4.5.2 方法封装规范

- 按业务模块划分方法文件（`course.ts`、`enrollment.ts` 等），方法命名与后端保持一致（如 `Course.ListForStudent`）

- 每个方法返回 Promise，统一处理成功/失败状态（基于 `code`）

- 方法 `params` 与返回值严格遵循 TS 类型定义，与共享包对齐

### 4.6 样式规范

#### 4.6.1 全局样式

- 颜色变量：定义主题色、辅助色、中性色（如`$primary-color: #1890ff`）

- 字体变量：定义字体大小、行高、字重

- 间距变量：定义统一的内边距、外边距（如`$gap-sm: 8px`、`$gap-md: 16px`）

- 全局重置：清除默认样式、设置盒模型为`border-box`

#### 4.6.2 组件样式

- 组件样式使用scoped属性，避免样式污染

- 复用样式通过SCSS混合（mixins）实现

- 响应式样式使用SCSS媒体查询混合（如`@include responsive-md { ... }`）

## 5. 页面与组件设计约束

### 5.1 页面设计约束

- 所有页面必须使用统一布局组件`AppLayout.vue`（登录页除外）

- 页面标题统一通过`PageHeader.vue`组件展示，包含页面标题和操作栏

- 数据列表页面必须使用统一的表格组件+分页组件，支持筛选、排序

- 表单页面必须使用Naive UI表单组件，支持表单验证、提交加载状态

### 5.2 组件设计约束

- 通用组件放置在`components/common/`，需保证无状态、高复用性

- 角色专属组件按角色划分目录，仅在对应角色路由下使用

- 组件Props和Emits必须定义TS类型，避免any类型

- 复杂组件拆分为子组件，单个组件代码量不超过500行

### 5.3 交互设计约束

- 按钮点击反馈：提交类按钮点击后显示加载状态，禁止重复点击

- 表单提交：先验证后提交，验证失败显示错误提示

- 数据加载：列表、详情页加载时显示加载动画，加载失败提供重试按钮

- 提示反馈：操作成功/失败使用Naive UI消息提示（`n-message`），重要操作使用确认弹窗（`n-dialog`）

## 6. 开发与构建规范

### 6.1 开发规范

- 代码风格：遵循ESLint + Prettier配置，提交代码前必须格式化

- TS类型：禁止使用any类型，复杂类型需定义接口或类型别名

- 命名规范：
  - 文件/组件：PascalCase（如`CourseBrowse.vue`）

  - 变量/函数：camelCase（如`userInfo`、`fetchCourses`）

  - 常量：UPPER_SNAKE_CASE（如`MAX_CREDITS`）

- 注释规范：组件、函数、复杂逻辑需添加注释，说明用途和参数

### 6.2 构建与部署

- 环境配置：统一从 `packages/config` 读取相关配置（不使用根 `.env`）

- 构建命令：`pnpm run build:frontend`（生成 dist 目录）
- 部署说明：前端不使用容器；生产可由静态服务器（如 Nginx）托管 `dist/`，由运维统一接入
- 目录约束：类型相关文件统一归档至 `src/styles/types/`

- 静态资源：构建后静态资源路径配置为相对路径，便于任意静态服务器托管

### 6.3 路径别名与工作区依赖（新增）

- 路径别名：统一使用 `@` 前缀，避免相对路径（如 `@api/rpc`、`@stores/auth.store`、`@router/index`、`@layouts/AppLayout.vue`、`@styles/global.scss`）。
- Vite 类型：`tsconfig.json` 增加 `types: ['vite/client']`，以支持 `import.meta.glob` 的类型推断。
- 工作区依赖：前端通过 `package.json` 依赖 `@packages/config` 与 `@packages/shared-types`，以包名导入公共配置与类型。

### 6.4 登录后行为（调整）

- 登录后按角色跳转各自默认页：
  - 学生：`/enrollment/select`
  - 教师：`/courses/manage/my`
  - 管理员/超管：`/system/users`
- 路由架构统一，无单一 dashboard；侧边栏与路由按权限动态生成。

### 6.5 权限接口（补充）

- 权限数据通过 RPC `Auth.GetPermissions` 获取；登录后前端自动调用并写入 Pinia 的权限与菜单 Store。

### 6.6 页面数据源与占位说明（新增）

- 我的课表（/enrollment/schedule）：采用分页展示，当前为占位数据；后续统一数据源为后端 `class_schedules` 表。
- 教师我的课程（/courses/manage/my）：调用 `Course.ListByTeacher` 分页接口，筛选项与学生课程列表一致（keyword/credit/status/学年/学期）。
- 用户管理（/system/users）：列表/筛选/分页已落地；新增/编辑（含初始密码）与软删除（通过 status 切换）已在前端实现占位，后端 RPC 方法补齐后即联通；权限按 `user_management` 的 `view/create/edit/delete` 控制。

### 6.7 UI 统一方案与 Provider（新增）

- 统一采用 Naive UI：按钮（NButton）、菜单（NMenu）、面包屑（NBreadcrumb）、分页（NDataTable+NPagination）、对话框/消息（NDialogProvider/NMessageProvider）、日期时间（NDateTimePicker）。
- Provider 栈：`App.vue` 中用 `NConfigProvider` + `NMessageProvider` + `NDialogProvider` 全局包裹。
- 主题策略：默认“跟随系统”（auto），Header 使用 NSwitch 双态展示当前浅/深状态；`NConfigProvider` 根据 `app.store.isDark` 应用 `darkTheme`。

### 6.8 分页策略（新增）

- 所有列表统一使用 `NDataTable` 的内置 `pagination` 对象：`{ page, pageSize, pageCount, pageSizeOptions, onUpdatePage, onUpdatePageSize }`。
- 默认 `pageSize=10`，`pageSizeOptions=[10, 20, 50]`，变更页码或页容量均触发数据拉取。

### 6.9 Stylelint 配置（新增）

- 本地配置：`apps/frontend/.stylelintrc.cjs`，扩展 `stylelint-config-standard`、`stylelint-config-standard-scss`、`stylelint-config-html`，Vue 文件使用 `postcss-html` 解析。
- 目的：避免出现环境不一致导致的 Unknown rule 错误，统一样式校验规则。

## 7. 核心页面示例（简化）

### 7.1 登录页（Login.vue）

```Plain Text
<template>
  <div class="login-container">
    <n-card class="login-card">
      <div class="login-header">
        <n-icon name="school" size="32" class="logo" />
        <h2>研究生排课系统</h2>
      </div>
      <n-form :model="form" :rules="rules" ref="formRef" label-width="80px">
        <n-form-item label="用户名" path="username">
          <n-input v-model:value="form.username" placeholder="请输入学号/工号" />
        </n-form-item>
        <n-form-item label="密码" path="password">
          <n-input v-model:value="form.password" type="password" placeholder="请输入密码" />
        </n-form-item>
        <n-form-item label="角色" path="role">
          <n-select v-model:value="form.role" :options="roleOptions" placeholder="请选择角色" />
        </n-form-item>
        <n-form-item>
          <n-button type="primary" @click="handleLogin" :loading="loading" class="login-btn">
            登录
          </n-button>
        </n-form-item>
      </n-form>
    </n-card>
  </div>
</template>
```

### 7.2 学生选课页面（CourseSelection.vue）

```Plain Text
<template>
  <div class="course-selection-page">
    <page-header title="选课操作" :actions="pageActions" />
    <div class="search-bar">
      <search-input v-model:value="searchKey" placeholder="搜索课程名/教师" @search="fetchCourses" />
      <n-select v-model:value="deptFilter" placeholder="选择院系" :options="deptOptions" @change="fetchCourses" />
      <n-select v-model:value="typeFilter" placeholder="课程类型" :options="typeOptions" @change="fetchCourses" />
    </div>
    <n-table :data="courseList" :columns="columns" row-key="id" :loading="loading">
      <template #cell="props">
        <template v-if="props.column.key === 'action'">
          <n-button type="primary" size="small" @click="handleSelectCourse(props.row)" :disabled="props.row.enrolled_count >= props.row.capacity">
            选课
          </n-button>
          <n-button type="text" size="small" @click="handleViewDetail(props.row)">
            详情
          </n-button>
        </template>
      </template>
    </n-table>
    <table-pagination :total="total" :page-size="pageSize" :current-page="currentPage" @page-change="handlePageChange" />
  </div>
</template>
```

## 8. 交付物要求

- 前端项目目录结构完整，符合本文档定义

- 核心页面（登录页、首页、课程浏览、选课操作、成绩查询）可正常访问

- 权限控制生效，不同角色只能看到对应模块和操作

- 响应式设计适配桌面端和移动端

- 接口请求正常对接后端，无跨域问题

- 代码符合规范，无ESLint错误

- 与后端/数据库联调通过本机开发环境，数据库容器由 `apps/backend/docker-compose.db.yml` 管理

---
